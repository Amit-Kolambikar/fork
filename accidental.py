#!/usr/bin/python


#  PROJECT HONEY POT ADDRESS DISTRIBUTION SCRIPT
#  For more information visit: http://www.projecthoneypot.org/
#  Copyright (C) 2004-2013, Unspam Technologies, Inc.
#  
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#  
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#  
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
#  02111-1307  USA
#  
#  If you choose to modify or redistribute the software, you must
#  completely disconnect it from the Project Honey Pot Service, as
#  specified under the Terms of Service Use. These terms are available
#  here:
#  
#  http://www.projecthoneypot.org/terms_of_service_use.php
#  
#  The required modification to disconnect the software from the
#  Project Honey Pot Service is explained in the comments below. To find the
#  instructions, search for:  *** DISCONNECT INSTRUCTIONS ***
#  
#  Generated On: Mon, 06 May 2013 16:26:56 -0700
#  For Domain: danrs.ch
#  
#  


#  *** DISCONNECT INSTRUCTIONS ***
#  
#  You are free to modify or redistribute this software. However, if
#  you do so you must disconnect it from the Project Honey Pot Service.
#  To do this, you must delete the lines of code below located between the
#  *** START CUT HERE *** and *** FINISH CUT HERE *** comments. Under the
#  Terms of Service Use that you agreed to before downloading this software,
#  you may not recreate the deleted lines or modify this software to access
#  or otherwise connect to any Project Honey Pot server.
#  
#  *** START CUT HERE ***
#  
__REQUEST_HOST    = 'hpr9.projecthoneypot.org'
__REQUEST_PORT    = '80'
__REQUEST_SCRIPT  = '/cgi/serve.php'
#  
#  *** FINISH CUT HERE ***
#  

__HPOT_TAG1       = '630403c1273ee78d740e0d4cdb6c1e66'
__HPOT_TAG2       = 'e12a3772c5a495eac2a27b3e71934940'
__HPOT_TAG3       = 'd19f5da5c91195b739432dac8050cc1c'

__CLASS_STYLE_1   = 'ramonitawacl'
__CLASS_STYLE_2   = 'pruja'

__DIV1            = 'clajiswepr'

__VANITY_L1       = 'MEMBER OF PROJECT HONEY POT'
__VANITY_L2       = 'Spam Harvester Protection Network'
__VANITY_L3       = 'provided by Unspam'

__DOC_TYPE1       = '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n'
__HEAD1           = '<html>\n<head>\n'
__HEAD2           = '<title>Outer Sack,danrs.ch</title>\n</head>\n'
__ROBOT1          = '<meta name="robots" content="noindex,noarchive,follow">\n'
__NOCOLLECT1      = '<meta name="no-email-collection" content="/">\n'
__TOP1            = '<body>\n<div align="center">\n'
__EMAIL1A         = '<a href="mailto:'
__EMAIL1B         = '" style="display: none;">'
__EMAIL1C         = '</a>'
__EMAIL2A         = '<a href="mailto:'
__EMAIL2B         = '" style="display:none;">'
__EMAIL2C         = '</a>'
__EMAIL3A         = '<a style="display: none;" href="mailto:'
__EMAIL3B         = '">'
__EMAIL3C         = '</a>'
__EMAIL4A         = '<a style="display:none;" href="mailto:'
__EMAIL4B         = '">'
__EMAIL4C         = '</a>'
__EMAIL5A         = '<a href="mailto:'
__EMAIL5B         = '"></a>'
__EMAIL5C         = '..'
__EMAIL6A         = '<span style="display: none;"><a href="mailto:'
__EMAIL6B         = '">'
__EMAIL6C         = '</a></span>'
__EMAIL7A         = '<span style="display:none;"><a href="mailto:'
__EMAIL7B         = '">'
__EMAIL7C         = '</a></span>'
__EMAIL8A         = '<!-- <a href="mailto:'
__EMAIL8B         = '">'
__EMAIL8C         = '</a> -->'
__EMAIL9A         = '<div id="'+__DIV1+'"><a href="mailto:'
__EMAIL9B         = '">'
__EMAIL9C         = '</a></div><br><script language="JavaScript" type="text/javascript">document.getElementById(\''+__DIV1+'\').innerHTML=\'\';</script>'
__EMAIL10A        = '<a href="mailto:'
__EMAIL10B        = '"><!-- '
__EMAIL10C        = ' --></a>'
__LEGAL1          = ''
__LEGAL2          = '\n'
__STYLE1          = '\n<style>a.'+__CLASS_STYLE_1+'{color:#FFF;font:bold 10px arial,sans-serif;text-decoration:none;}</style>'
__VANITY1         = '<table cellspacing="0"cellpadding="0"border="0"style="background:#999;width:230px;"><tr><td valign="top"style="padding: 1px 2px 5px 4px;border-right:solid 1px #CCC;"><span style="font:bold 30px arial,sans-serif;color:#666;top:0px;position:relative;">@</span></td><td valign="top" align="left" style="padding:3px 0 0 4px;"><a href="http://www.projecthoneypot.org/" class="'+__CLASS_STYLE_1+'">'+__VANITY_L1+'</a><br><a href="http://www.unspam.com"class="'+__CLASS_STYLE_1+'">'+__VANITY_L2+'<br>'+__VANITY_L3+'</a></td></tr></table>\n'
__BOTTOM1         = '</div>\n</body>\n</html>\n'


def _getLegalContent(): 
    return '<table border="0" cellpadding="0" cellspacing="0">\n<tr>\n<td style="font-family: monospace;">&nbsp;&nbsp; <b><font color=white>s</font></b><br>&nbsp;<br>&#84;he <br>to y<br>othe<br>Webs<br>re&#97;d<br>agen<br>them<br>&#110;on-<br>Webs<br><br><b><font color=white>a</font></b>&nbsp;&nbsp; <br>&nbsp;<br>S&#112;ec<br>Non-<br>spid<br>prog<br>auto<br><br>Emai<br>I&#116; i<br>alon<br>h&#97;s <br>st&#111;r<br>valu<br>stor<br>ag&#114;e<br><br>&nbsp; &nbsp; <br>&nbsp;<br>Each<br>aga&#105;<br>&#40;"&#74;u<br>the <br>such<br>and <br>o&#102; f<br>a&#110;y <br>Serv<br>the <br><br>&nbsp; &nbsp; <br>&nbsp;<br>You <br>may<font color=white>k</font><br>abus<br>Vis&#105;<br><br>VISI<br>PART<br>SU<span style="display: none">deserted worker</span>BS<br></td>\n<td style="font-family: monospace;">&nbsp; &nbsp; <br><br>webs<br>ou s<br>r te<br>ite<font color=white>c</font><br>&nbsp;t&#104;e<br>ts o<br>. T&#104;<br>&#116;r&#97;n<br>i&#116;e.<br><br>&nbsp;&nbsp; <b><font color=white>a</font></b><br><br>ial <br>H&#117;ma<br>ers,<br>&#114;ams<br>m&#97;ti<br><br>l ad<br>&#115; re<br>e&#46; Y<br>a va<br>age,<br>e of<br>&#105;&#110;g <br>emen<br><br>&nbsp; &nbsp; <br><br>&nbsp;par<br>nst <br>dic&#105;<br>regi<br>&nbsp;law<br>per&#102;<br>ede&#114;<br>ac&#116;i<br>&#105;&#99;e.<br>abov<br><br>&nbsp; <b><font color=white>o</font><font color=white>s</font></b><br><br>cons<br>appe<span style="display: none">lawyers</span><br>e<span style="display: none">pace funicular sample newspaper</span>. T<br>&#116;ors<br><br>TORS<br>Y OR<br>EQUE<br></td>\n<td style="font-family: monospace;">&nbsp; &nbsp; <br><br>it&#101; <br>ubje<br>r&#109;s <br>you <br>m<font color=white>e</font>ca<br>f<font color=white>a</font>th<br>e ac<br>sfer<br><br><br>&nbsp; &nbsp; <br><br>&#114;e&#115;t<br>n Vi<br>&nbsp;b&#111;t<br>&nbsp;des<br>c&#97;ll<br><br>dres<br>c&#111;gn<br>ou a<br>lue <br>&nbsp;and<br>&nbsp;th&#101;<br>thi&#115;<br>t an<br><br>&nbsp; &nbsp; <br><br>ty a<br>the<font color=white>g</font><br>al A<br>ster<br>s &#97;&#114;<br>or&#109;e<br>al<font color=white>p</font>a<br>on<font color=white>g</font>b<br>&nbsp;You<br>&#101; ag<br><br>&nbsp; <b><font color=white>t</font></b>&nbsp;<br><br>e&#110;t <br>ar s<br>h&#101; I<br><font color=white>d</font>agr<br><br>&nbsp;AG&#82;<br>&nbsp;SEN<br>NT B<br></td>\n<td style="font-family: monospace;"><b><font color=white>f</font></b>&nbsp;&nbsp; <br><br>f&#114;om<br>&#99;t t<span style="display: none">smile recipient flippant documentation</span><br>gove<br>a&#99;ce<br>refu<br>e in<br>cess<br>&#97;bl&#101;<br><br><br>&nbsp;&nbsp; <b>S</b><br><br>ri&#99;t<br>sito<br>&#115;&#44; i<br>ig&#110;e<br>&#121;&#46;<br><br>ses <br>ized<br>c<span style="display: none">genuine routine large bedding swanky</span>kno<br>not<font color=white>p</font><br>/<span style="display: none">distressed downward dye</span>or <br>se<font color=white>f</font>a<br>&nbsp;We&#98;<br>d ex<br><br>&nbsp; <b><font color=white>a</font></b>&nbsp;<br><br>g&#114;ee<br>&#111;the<br>&#99;tio<br>&#101;d<font color=white>a</font>A<br>e ap<br>d en<br>nd<font color=white>h</font>s<br>roug<br>&nbsp;con<br>reem<br><br>&nbsp; &nbsp; <br><br>to &#104;<br>&#111;&#109;&#101;w<br>dent<br>&#101;&#101; n<br><br>EE T<br>DING<br>RE&#65;C<br></td>\n<td style="font-family: monospace;"><b><font color=white>f</font></b>&nbsp;&nbsp; <br><br>&nbsp;wh&#105;<br>o th<br>&#114;nin<br>pt t<br>lly.<br>divi<br>&nbsp;rig<br>&nbsp;&#119;it<br><br><br><b>PEC&#73;</b><br><br>io&#110;s<br>rs. <br>ndex<br>d<font color=white>t</font>to<br><br><br>on<font color=white>h</font>t<br>&nbsp;tha<br>w&#108;ed<br>less<br>dist<br>ddre<br>&#115;ite<br>pres<br><br>&nbsp; &nbsp; <br><br>s th<br>r<font color=white>d</font>in<br>n") <br>d&#109;&#105;n<br>plie<br>t&#105;r<span style="display: none">science referendum eager</span>e<br>tate<br>ht<font color=white>o</font>a<br>sent<br>ent.<br><br>&nbsp; &nbsp; <br><br>avin<br>h&#101;re<br>ifie<br>ot t<br><br>HAT <br>&nbsp;&#65;NY<br>H OF<br></td>\n<td style="font-family: monospace;">&nbsp; &nbsp; <br><br>ch y<br>e f&#111;<br>g ac<br>h&#101;&#115;e<br>&nbsp;A&#110;y<br>du&#97;l<br>h&#116;&#115; <br>h&#111;ut<br><br><br><b>AL</b>&nbsp;<b>L</b><br><br>&nbsp;&#111;n <br>Non-<br>ers,<br>&nbsp;acc<br><br><br>his <br>t th<br>ge a<br>&nbsp;tha<br>r&#105;bu<br>sse<span style="display: none">cycle garage task</span>s<br>\'s<font color=white>d</font>&#101;<br>sly <br><br><b><font color=white>e</font></b>&nbsp;&nbsp; <br><br>at a<br>&nbsp;&#99;&#111;n<br>shal<br>istr<br>d to<br>ly w<br>&nbsp;co&#117;<br>ga<span style="display: none">goodtempered rare</span>in<span style="display: none">men load pet</span><br><font color=white>t</font>to <br><br><br>&nbsp;<b><font color=white>e</font></b>&nbsp; <br><br>g yo<br>&nbsp;o<span style="display: none">canal ocean wall</span>n <br>r is<br>o us<br><br>HARV<br><font color=white>k</font>&#77;ES<br><font color=white>t</font>THE<br></td>\n<td style="font-family: monospace;">&nbsp;&nbsp; <b>T</b><br><br>ou<font color=white>k</font>a<br>l&#108;ow<br>ces<span style="display: none">finny unprofessional longstanding banker</span>s<br>&nbsp;ter<br>&nbsp;Non<br>(s&#41; <br>gran<br><font color=white>t</font>the<br><br><br><b>I&#67;EN</b><br><br>a<font color=white>s</font>v&#105;<br>Hu&#109;a<br>&nbsp;&#114;ob<br>ess,<br><br><br>site<br>es&#101; <br>nd a<span style="display: none">required</span><br>&#110; U&#83;<br>tion<br>. I&#110;<br>mail<span style="display: none">injured criminal gone</span><br>pr&#111;h<br><br>&nbsp;<b>AP&#80;</b><br><br>ny<font color=white>f</font>s<br>nect<br>l be<br>ativ<br>&nbsp;agr<br>&#105;thi<br>rts <br>st<font color=white>d</font>h<br>elec<br><br><br><b>RECO</b><br><br>&#117;r &#73;<br>this<br>&nbsp;uni<br>e th<br><br>&#69;&#83;TI<br>SAGE<br>SE T<br></td>\n<td style="font-family: monospace;"><b>ERMS</b><br><br>cces<br>ing <br>&nbsp;to <br>ms a<br>&#45;&#72;&#117;m<br>who <br>ted <br>&nbsp;exp<br><br><br><b>SE</b>&nbsp;<b>R</b><br><br>&#115;ito<br>n Vi<br>o&#116;s,<br>&nbsp;rea<br><br><br>&nbsp;are<br>emai<br>gr&#101;e<br>&nbsp;$50<br>&nbsp;of<font color=white>h</font><br>t<span style="display: none">ravens glaucous romantic</span>e&#110;t<br>&nbsp;add<br>ibit<br><br><b>L&#73;C&#65;</b><br><br>u&#105;&#116;,<br>ion <br>&nbsp;&#103;ov<br>e &#67;o<br>eeme<br>n th<br>with<br>im<font color=white>a</font>i<br>tron<br><br><br><b>R&#68;S</b>&nbsp;<br><br>nter<br>&nbsp;&#112;ag<br>q&#117;el<br>is &#97;<br><br>NG, <br>(&#83;&#41; <br>E&#82;MS<br></td>\n<td style="font-family: monospace;">&nbsp;<b>AND</b><br><br>sed <br>c&#111;&#110;d<br>the<span style="display: none">it</span>&nbsp;<br>n&#100; c<br>an V<br>co&#110;t<br>to &#121;<br>ress<br><br><br><b>ESTR</b><br><br>r\'s <br>sito<br>&nbsp;cra<br>d, c<br><br><br><font color=white>d</font>&#99;o&#110;<br>l &#97;d<br>&nbsp;tha<br>. Y&#111;<br>thes<br>iona<br>ress<span style="display: none">darkness scope typical hedge</span><br>&#101;d.<br><br><b>&#66;LE</b>&nbsp;<br><br>&nbsp;act<br>with<br>ern&#101;<br>&#110;&#116;ac<br>nts <br>e Ad<br>in t<br>n co<br>ic s<br><br><br><b>OF</b>&nbsp;<b>V</b><br><br>net <br>e &#40;t<br>y ma<br>d&#100;re<br><br>GATH<br>T&#79; &#84;<br><font color=white>k</font>O&#70; <br></td>\n<td style="font-family: monospace;">&nbsp;<b>CON</b><br><br>t&#104;is<br>itio<br>&#87;&#101;b<span style="display: none">fog opposite</span>s<br>on&#100;&#105;<br>i&#115;it<br>&#114;ols<br>ou u<br>&nbsp;wri<br><br><br><b>ICTI</b><br><br>lic<span style="display: none">mum rail gate grouchy</span>e<br>&#114;s i<br>wler<br>o&#109;&#112;i<br><br><br>side<br>d&#114;es<br>t ea<br>u fu<br>&#101; a&#100;<br>l &#99;o<br>es i<br><br><br><b>LAW</b>&nbsp;<br><br>ion <br>&nbsp;or <br>d by<br>t (t<br>be&#116;w<br>min <br>&#104;e A<br>nn&#101;c<br>&#101;&#114;vi<br><br><br><b>ISIT</b><br><br>Pr&#111;t<span style="display: none">hardcover</span><br>&#104;e "<br>tc&#104;e<br>ss f<br><br>ERIN<br>HE I<br>S<span style="display: none">unrealistic hospitable courtesy hillbilly</span>ER&#86;<br></td>\n<td style="font-family: monospace;"><b>DITI</b><br><br>&nbsp;agr<br>ns. <br>ite.<br>ti&#111;n<br>ors <br>,<font color=white>a</font>au<br>&#110;&#100;&#101;r<br>tten<br><br><br><b>ONS</b>&nbsp;<br><br>n&#115;e<span style="display: none">scholarly</span>&nbsp;<br>ncl<span style="display: none">head beach</span>u<br>s, h<br>le o<br><br><br>red <br>se<span style="display: none">proforma privileged album</span>s <br>ch e<br>&#114;the<br>dres<br>llec<br>s re<br><br><br><b>AND</b>&nbsp;<br><br>or p<br>aris<br>&nbsp;the<br>he "<br>ee&#110; <br>St&#97;t<br>&#100;mi&#110;<br>tion<br>ce o<br><br><br><b>OR</b>&nbsp;<b>U</b><br><br>ocol<br>Id&#101;n<br>d<font color=white>s</font>to<br>o&#114; a<br><br>G,<font color=white>f</font>S<br>DENT<br>ICE.<br></td>\n<td style="font-family: monospace;"><b>ON&#83;</b>&nbsp;<br><br>&#101;eme<br>&#84;hes<br>&nbsp;B&#121; <br>s &#40;t<br>to &#116;<br>tho&#114;<br><font color=white>c</font>the<br>&nbsp;pe&#114;<br><br><br><b>FOR</b>&nbsp;<br><br>to &#97;<br>de, <br>arv<span style="display: none">sadness heart</span>e<span style="display: none">demonic</span><br>r ga<br><br><br>prop<br>are <br>mai&#108;<br>&#114;<font color=white>c</font>ag<br>ses <br>tion<br>cogn<br><br><br><b>JURI</b><br><br>r&#111;&#99;e<br>&#105;n&#103; <br>&nbsp;law<br>A&#100;&#109;i<br>Admi<br>e. Y<br>&nbsp;Sta<br>&nbsp;w&#105;t<br>f pr<br><br><br><b>S&#69;</b>&nbsp;<b>A</b><br><br>&nbsp;a&#100;d<br>tifi<br>&nbsp;you<br>ny r<br><br>TORI<br>IFIE<br><br></td>\n<td style="font-family: monospace;"><b>OF</b>&nbsp;<b>U</b><br><br>nt (<br>&#101; te<br>v&#105;si<br>he<font color=white>d</font>"<br>he &#87;<br>&#115; o&#114;<br>&nbsp;Ter<br>mi&#115;&#115;<br><br><br><b>&#78;ON-</b><br><br>cces<br>b&#117;t <br>ster<br>ther<br><br><br>riet<br>&#112;r&#111;&#118;<br>&nbsp;add<br>&#114;ee <br>subs<br>, ha<br>ized<br><br><br><b>SDIC</b><br><br>edin<br>from<br>&nbsp;of <br>n St<br>n<font color=white>i</font>St<br>o&#117; c<br>te. <br>h br<br>oces<br><br><br><b>ND</b>&nbsp;<b>A</b><br><br>ress<span style="display: none">pyramidal adorable monotone party father</span><br>&#101;r"&#41;<br>r I&#110;<br>easo<br><br>NG, <br>R CO<br><br></td>\n<td style="font-family: monospace;"><b>&#83;E</b>&nbsp;<br><br>"t&#104;e<br>rms <br>ting<br>Ter&#109;<br>ebsi<br>&nbsp;oth<br>ms &#111;<br>ion <br><br><br><b>HUMA</b><br><br>s th<br>are<font color=white>i</font><br>s, o<br>&nbsp;con<span style="display: none">selected softcover fine causal foamy</span><br><br><br>ary<font color=white>s</font><br>ided<br>&#114;ess<br>t&#104;a&#116;<br>tant<br>r&#118;es<br>&nbsp;as<font color=white>c</font><br><br><br><b>TION</b><br><br>g br<br>&nbsp;&#116;&#104;e<br>th&#101; <br>ate"<br>ate <br>onse<br>Y&#111;u <br>e&#97;ch<br>s re<br><br><br><b>BUSE</b><br><br>&nbsp;rec<br>&nbsp;if<font color=white>t</font><br>te&#114;n<br>n&#46;<br><br>&#84;&#82;&#65;N<br>NSTI<br><br></td>\n<td style="font-family: monospace;"><br><br>&nbsp;Web<br>are <br>&nbsp;(in<br>s of<br>te<font color=white>a</font>s<br>e&#114;w&#105;<br>f Se<br>of t<span style="display: none">catholic weekend</span><br><br><br><b>N</b>&nbsp;<b>VI</b><br><br>e &#87;e<br>not <br>r an<br>tent<br><br><br>inte<br>&nbsp;fo&#114;<br>&nbsp;&#116;he<br>&nbsp;&#116;he<br>iall<br>ti&#110;&#103;<br>a &#118;&#105;<br><br><br>&nbsp;<br><br>ough<br>&nbsp;Ter<br>stat<br>) fo<br>res&#105;<br>nt t<br>c&#111;ns<br>es o<br>gard<br><br><br>&nbsp;<br><br>or&#100;e<span style="display: none">other meteorologists nonskid</span><br>we s<br>et P<br><br><br>SFE&#82;<br>TUTE<br><br></td>\n<td style="font-family: monospace;"><br><br>s<span style="display: none">bean</span>ite<br>in a<br>&nbsp;an&#121;<br>&nbsp;Ser<br>hall<br>se m<br>rvic<br>he o<br><br><br><b>SITO</b><br><br>&#98;sit<br>l&#105;mi<br>y ot<br>&nbsp;fro<br><br><br>llec<br>&nbsp;hum<span style="display: none">satisfying</span><br>&nbsp;Web<br>&nbsp;com<br>y di<span style="display: none">warning inquiry kingdom</span><br>, ga<br>olat<br><br><br><br><br>t by<br>ms o<br>e of<br>r th<br>&#100;ent<br>o th<br>en&#116; <br>f th<br>ing <br><br><br><br><br>&#100;. &#65;<br>usp&#101;<br>&#114;o&#116;o<br><br><br>RING<br>&#83; AN<br><br></td>\n<td style="font-family: monospace;"><br><br>") i<br>&#100;dit<br><font color=white>g</font>man<br>vice<br>&nbsp;be <br>akes<br>e ar<br>&#119;ner<br><br><br><b>RS</b>&nbsp;<br><br>e ap<br>t<span style="display: none">drudge herrings speculation engine</span>e<span style="display: none">activity useful devil causal</span>&#100; <br>&#104;&#101;r <br>m th<br><br><br>&#116;ua<span style="display: none">palm collective borrowing</span>l<br>&#97;n v<br>&#115;ite<br>pila<br>&#109;ini<br>ther<br>ion <br><br><br><br><br>&nbsp;s&#117;c<br>f<font color=white>s</font>&#83;e<br>&nbsp;res<br>e We<br>s en<br>e &#106;u<br>&#116;o<font color=white>s</font>t<br>e<span style="display: none">monohydroxy avenue</span>se<font color=white>k</font><br>&#97;ct<span style="display: none">architectural leg knights timelapse</span>i<br><br><br><br><br>n &#101;m<br>ct<font color=white>h</font>p<br>col <br><br><br>&nbsp;TO <br>&nbsp;AC&#67;<br><br></td>\n<td style="font-family: monospace;"><br><br>s pr<br>ion <br>&#110;er)<br>"). <br>cons<br>&nbsp;use<br>e<br>&nbsp;&#111;f <br><br><br><br><br>p&#108;y <br>&#116;o&#44; <br>com&#112;<br>e We<br><br><br>&nbsp;&#112;ro<br>i<span style="display: none">peasant</span>s&#105;t<br><font color=white>t</font>co&#110;<br>&#116;&#105;on<br>shes<br>ing&#44;<br>o&#102; &#116;<br><br><br><br><br>h pa<br>rvic<br>i&#100;en<br>bsit<br>ter&#101;<br>risd<br>he v<br>Te<span style="display: none">particle impregnable horseless ingrown caravan</span>r&#109;<br>ons <br><br><br><br><br>ail <br>&#111;ten<br>addr<br><br><br>&#65; &#84;&#72;<br>EPTA<br><br></td>\n<td style="font-family: monospace;"><br><br>ovid<br>to a<br>&nbsp;the<br>Plea<br>&#105;der<br>&nbsp;of<br><br>the<br><br><br><br><br>to<br>web<br>ute&#114;<br>bsit<br><br><br>pert<br>o&#114;s<br>ta&#105;&#110;<br>,<br>&nbsp;the<br>&nbsp;and<br>his<br><br><br><br><br>rty<br>e<br>ce o<br>&#101; as<br>d<font color=white>p</font>in<br>icti<br>enue<br>s &#111;f<br>&#117;nde<br><br><br><br><br>a&#100;dr<br>&#116;ial<br>ess.<br><br><br>IRD<br>NCE <br><br></td>\n<td style="font-family: monospace;"><br><br>&#101;d<br>n&#121;<br><br>se<br>ed<br><br><br><br><br><br><br><br><br><br><br>e<br><br><br>&#121;.<br><br>s<br><br><br>/or<br><br><br><br><br><br><br><br>f<br><br>to<br>on<br><font color=white>i</font>in<br><br>r<br><br><br><br><br>e<span style="display: none">reptile</span>ss<br><br><br><br><br><br>A&#78;D<br><br></td>\n</tr>\n</table>\n<br>'







del __CLASS_STYLE_1, __CLASS_STYLE_2, __DIV1, __VANITY_L1, __VANITY_L2, __VANITY_L3

__version__ = "1.3"

def _formatHTML( s ):
    return s.replace( r"\n", "\n" )

def _getDocType( _formatHTML = _formatHTML, __DOC_TYPE1 = __DOC_TYPE1 ): 
    return _formatHTML( __DOC_TYPE1 )
del __DOC_TYPE1

def _getHeadHTML1( _formatHTML = _formatHTML, __HEAD1 = __HEAD1 ):
    return _formatHTML( __HEAD1 )
del __HEAD1

def _getRobotHTML( _formatHTML = _formatHTML, __ROBOT1 = __ROBOT1 ):
    return _formatHTML( __ROBOT1 )
del __ROBOT1

def _getNoCollectHTML( _formatHTML = _formatHTML,
                       __NOCOLLECT1 = __NOCOLLECT1 ):
    return _formatHTML( __NOCOLLECT1 )
del __NOCOLLECT1

def _getHeadHTML2( _formatHTML = _formatHTML, __HEAD2 = __HEAD2 ):
    return _formatHTML( __HEAD2 )
del __HEAD2

def _getTopHTML( _formatHTML = _formatHTML, __TOP1 = __TOP1 ):
    return _formatHTML( __TOP1 )
del __TOP1

def _getEmailHTML( method, m,
                   _formatHTML = _formatHTML,
                   __EMAIL1A = __EMAIL1A, __EMAIL1B = __EMAIL1B, __EMAIL1C = __EMAIL1C,
                   __EMAIL2A = __EMAIL2A, __EMAIL2B = __EMAIL2B, __EMAIL2C = __EMAIL2C,
                   __EMAIL3A = __EMAIL3A, __EMAIL3B = __EMAIL3B, __EMAIL3C = __EMAIL3C,
                   __EMAIL4A = __EMAIL4A, __EMAIL4B = __EMAIL4B, __EMAIL4C = __EMAIL4C,
                   __EMAIL5A = __EMAIL5A, __EMAIL5B = __EMAIL5B, __EMAIL5C = __EMAIL5C,
                   __EMAIL6A = __EMAIL6A, __EMAIL6B = __EMAIL6B, __EMAIL6C = __EMAIL6C,
                   __EMAIL7A = __EMAIL7A, __EMAIL7B = __EMAIL7B, __EMAIL7C = __EMAIL7C,
                   __EMAIL8A = __EMAIL8A, __EMAIL8B = __EMAIL8B, __EMAIL8C = __EMAIL8C,
                   __EMAIL9A = __EMAIL9A, __EMAIL9B = __EMAIL9B, __EMAIL9C = __EMAIL9C,
                   __EMAIL10A = __EMAIL10A, __EMAIL10B = __EMAIL10B, __EMAIL10C = __EMAIL10C ):
    return { 0: "",
             1: _formatHTML( __EMAIL1A + m + __EMAIL1B + m + __EMAIL1C ),
             2: _formatHTML( __EMAIL2A + m + __EMAIL2B + m + __EMAIL2C ), 
             3: _formatHTML( __EMAIL3A + m + __EMAIL3B + m + __EMAIL3C ), 
             4: _formatHTML( __EMAIL4A + m + __EMAIL4B + m + __EMAIL4C ), 
             5: _formatHTML( __EMAIL5A + m + __EMAIL5B ), 
             6: _formatHTML( __EMAIL6A + m + __EMAIL6B + m + __EMAIL6C ), 
             7: _formatHTML( __EMAIL7A + m + __EMAIL7B + m + __EMAIL7C ), 
             8: _formatHTML( __EMAIL8A + m + __EMAIL8B + m + __EMAIL8C ), 
             9: _formatHTML( __EMAIL9A + m + __EMAIL9B + m + __EMAIL9C ), 
             }.get( method, # if not found then default to method 10
                    _formatHTML( __EMAIL10A + m + __EMAIL10B + m + __EMAIL10C ) )
del __EMAIL1A, __EMAIL1B, __EMAIL1C
del __EMAIL2A, __EMAIL2B, __EMAIL2C
del __EMAIL3A, __EMAIL3B, __EMAIL3C 
del __EMAIL4A, __EMAIL4B, __EMAIL4C
del __EMAIL5A, __EMAIL5B, __EMAIL5C
del __EMAIL6A, __EMAIL6B, __EMAIL6C
del __EMAIL7A, __EMAIL7B, __EMAIL7C
del __EMAIL8A, __EMAIL8B, __EMAIL8C
del __EMAIL9A, __EMAIL9B, __EMAIL9C
del __EMAIL10A, __EMAIL10B, __EMAIL10C

def _getLegalHTML( _formatHTML = _formatHTML, __LEGAL1 = __LEGAL1,
                   _getLegalContent = _getLegalContent, __LEGAL2 = __LEGAL2 ):
    return _formatHTML( __LEGAL1 + _getLegalContent() + __LEGAL2 )
del __LEGAL1, _getLegalContent, __LEGAL2

def _getStyleHTML( _formatHTML = _formatHTML, __STYLE1 = __STYLE1 ):
    return _formatHTML( __STYLE1 )
del __STYLE1

def _getVanityHTML( _formatHTML = _formatHTML, __VANITY1 = __VANITY1 ):
    return _formatHTML( __VANITY1 )
del __VANITY1

def _getBottomHTML( _formatHTML = _formatHTML, __BOTTOM1 = __BOTTOM1 ):
    return _formatHTML( __BOTTOM1 )
del __BOTTOM1

def _performRequest( request,
                     __REQUEST_HOST = __REQUEST_HOST,
                     __REQUEST_PORT = __REQUEST_PORT,
                     __REQUEST_SCRIPT = __REQUEST_SCRIPT,
                     __HPOT_TAG2 = __HPOT_TAG2 ):
    import httplib
    headers = { "User-Agent": "PHPot" + " " + __HPOT_TAG2,
                "Host": __REQUEST_HOST,
                "Content-Type": "application/x-www-form-urlencoded",
                "Connection": "close",
                }
    h = httplib.HTTPConnection( "%s:%s" % ( __REQUEST_HOST, __REQUEST_PORT ) )
    h.request( "POST", __REQUEST_SCRIPT, request, headers )
    return h.getresponse().read()
del __REQUEST_HOST, __REQUEST_PORT, __REQUEST_SCRIPT

def _whoAmI():
    import hashlib
    try:
        r = __file__
    except:
        import sys
        r = sys.argv[ 0 ]
    body = open( r ).read()
    body = body.split( "\n", 1 )[ 1 ]
    return hashlib.md5( body ).hexdigest()

def _prepareRequest( REQUEST, forcePortNumber = None,
                     _whoAmI = _whoAmI, __HPOT_TAG1 = __HPOT_TAG1,
                     __HPOT_TAG2 = __HPOT_TAG2, __HPOT_TAG3 = __HPOT_TAG3 ):
    from sys import version
    postvars = {}
    postvars[ "tag1" ] = __HPOT_TAG1
    postvars[ "tag2" ] = __HPOT_TAG2
    postvars[ "tag3" ] = __HPOT_TAG3
    postvars[ "tag4" ] = _whoAmI()
    postvars[ "ip" ] = REQUEST[ "REMOTE_ADDR" ]
    postvars[ "svrn" ] = ( REQUEST.get( "HTTP_HOST", "" )
                           or REQUEST.get( "SERVER_NAME", "" ) )
    postvars[ "svp" ] = forcePortNumber or REQUEST.get( "SERVER_PORT", "80" ) 
    postvars[ "svip" ] = REQUEST.get( "SERVER_ADDR", "" )
    postvars[ "rquri" ] = ( REQUEST.get( "REQUEST_URI", "" ) 
                            or REQUEST.get( "PATH_INFO", "" ) )
    postvars[ "version" ] = __version__ + "-" + version.split()[ 0 ]
    postvars[ "sn" ] = ( REQUEST.get( "SCRIPT_NAME", "" )
                         or REQUEST.get( "PATH_TRANSLATED", "" ) )
    postvars[ "ref" ] = REQUEST.get( "HTTP_REFERER", "" )
    postvars[ "uagnt" ] = REQUEST.get( "HTTP_USER_AGENT", "" )
    return postvars
del _whoAmI, __HPOT_TAG1, __HPOT_TAG2, __HPOT_TAG3

def _transcribeResponse( response ):
    import urllib
    settings = {}
    isParam = 0
    for line in response.split( "\n" ):
        if line == "<END>":
            isParam = 0
        if isParam:
            pieces = line.split( "=", 1 )
            settings[ pieces[ 0 ] ] = urllib.unquote_plus( pieces[ 1 ] )
        if line == "<BEGIN>":
            isParam = 1
    if settings.has_key( "directives" ):
        settings[ "directives" ] = settings[ "directives" ].split( "," )
    else:
        settings[ "directives" ] = [ "1" ] * 10
    settings[ "directives" ] = map( int, settings[ "directives" ] )
    for k, v in settings.items():
        try:
            settings[ k ] = int( v )
        except:
            pass
    return settings

def _getSettings( REQUEST, forcePortNumber = None,
                  _performRequest = _performRequest,
                  _prepareRequest = _prepareRequest,
                  _transcribeResponse = _transcribeResponse ):
    import urllib
    request = []
    for k, v in _prepareRequest( REQUEST, forcePortNumber ).items():
        request.append( k + "=" + urllib.quote( v ) )
    request = "&".join( request )
    response = _performRequest( request )
    return _transcribeResponse( response )
del _performRequest, _prepareRequest, _transcribeResponse

def _makeHTML( settings,
               _formatHTML = _formatHTML,
               _getBottomHTML = _getBottomHTML, _getDocType = _getDocType,
               _getEmailHTML = _getEmailHTML, _getHeadHTML1 = _getHeadHTML1,
               _getHeadHTML2 = _getHeadHTML2, _getLegalHTML = _getLegalHTML,
               _getNoCollectHTML = _getNoCollectHTML,
               _getRobotHTML = _getRobotHTML, _getStyleHTML = _getStyleHTML,
               _getTopHTML = _getTopHTML, _getVanityHTML = _getVanityHTML ):
    directives = settings[ "directives" ]
    email = settings.get( "email", None )
    emailmethod = settings.get( "emailmethod", None )
    return "".join ( [ directives[ 0 ] and _getDocType()  or "",
                       settings.get( "injDocType", 0 ) and _formatHTML( settings.get( "injDocTypeMsg", "" ) ) or "",
                       directives[ 1 ] and _getHeadHTML1() or "",
                       settings.get( "injHead1HTML", 0 ) and _formatHTML( settings.get( "injHead1HTMLMsg", "" ) ) or "",
                       directives[ 8 ] and _getRobotHTML() or "",
                       settings.get( "injRobotHTML", 0 ) and _formatHTML( settings.get( "injRobotHTMLMsg", "" ) ) or "",
                       directives[ 9 ] and _getNoCollectHTML() or "",
                       settings.get( "injNoCollectHTML", 0 ) and _formatHTML( settings.get( "injNoCollectHTMLMsg", "" ) ) or "",
                       directives[ 1 ] and _getHeadHTML2() or "",
                       settings.get( "injHead2HTML", 0 ) and _formatHTML( settings.get( "injHead2HTMLMsg", "" ) ) or "",
                       directives[ 2 ] and _getTopHTML() or "",
                       settings.get( "injTopHTML", 0 ) and _formatHTML( settings.get( "injTopHTMLMsg", "" ) ) or "",

                       settings.get( "actMsgOn", 0 ) and _formatHTML( settings.get( "actMsg", "" ) ) or "",
                       settings.get( "errMsgOn", 0 ) and _formatHTML( settings.get( "errMsg", "" ) ) or "",
                       settings.get( "customMsgOn", 0 ) and _formatHTML( settings.get( "customMsg", "" ) ) or "",

                       directives[ 3 ] and _getLegalHTML() or "",
                       settings.get( "injLegalHTML", 0 ) and _formatHTML( settings.get( "injLegalHTMLMsg", "" ) ) or "",
                       settings.get( "altLegalOn", 0 ) and _formatHTML( settings.get( "altLegalMsg", "" ) ) or "",

                       directives[ 4 ] and _getEmailHTML( emailmethod, email ) or "",
                       settings.get( "injEmailHTML", 0 ) and _formatHTML( settings.get( "injEmailHTMLMsg", "" ) ) or "",
                       directives[ 5 ] and _getStyleHTML() or "",
                       settings.get( "injStyleHTML", 0 ) and _formatHTML( settings.get( "injStyleHTMLMsg", "" ) ) or "",

                       directives[ 6 ] and _getVanityHTML() or "",
                       settings.get( "injVanityHTML", 0 ) and _formatHTML( settings.get( "injVanityHTMLMsg", "" ) ) or "",
                       settings.get( "altVanityOn", 0 ) and _formatHTML( settings.get( "altVanityMsg", "" ) ) or "",

                       directives[ 7 ] and _getBottomHTML() or "",
                       settings.get( "injBottomHTML", 0 ) and _formatHTML( settings.get( "injBottomHTMLMsg", "" ) ) or "",
                       ] )
del _formatHTML
del _getBottomHTML, _getDocType, _getEmailHTML
del _getHeadHTML1, _getHeadHTML2, _getLegalHTML, _getNoCollectHTML
del _getRobotHTML, _getStyleHTML, _getTopHTML, _getVanityHTML


def from_cgi( _getSettings = _getSettings, _makeHTML = _makeHTML ):
    """This function is to be called by CGI scripts.  It will print
    (to standard output) the Content-Type header and full page HTML
    for your honeypot."""
    print "Content-Type: text/html"
    print "Cache-Control: no-cache"
    print
    import os
    settings = _getSettings( os.environ )
    print _makeHTML( settings )


try:
    if __name__ == '__main__':
        from_cgi()
    else:
        del from_cgi
        def from_zope( REQUEST, forcePortNumber = None,
                       _getSettings = _getSettings, _makeHTML = _makeHTML ):
            """Pass this function the Zope REQUEST and it will return the
            full page HTML for your honeypot."""
            _getSettings = getattr( from_zope, 'getSettings', _getSettings )
            _makeHTML = getattr( from_zope, 'makeHTML', _makeHTML )
            if forcePortNumber:
                forcePortNumber = str( forcePortNumber )
            settings = _getSettings( REQUEST, forcePortNumber )
            return _makeHTML( settings )
        try:
            from_zope.getSettings = _getSettings
            from_zope.makeHTML = _makeHTML
        except:
            pass
        try:
            from_zope = from_zope.__call__
        except:
            pass
finally:
    try:
        del from_cgi
    except:
        pass
    del _getSettings, _makeHTML
